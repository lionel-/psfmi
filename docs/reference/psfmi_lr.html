<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pooling and Predictor selection function for Logistic regression
models in multiply imputed datasets — psfmi_lr • psfmi</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Pooling and Predictor selection function for Logistic regression
models in multiply imputed datasets — psfmi_lr" />

<meta property="og:description" content="psfmi_lr Pooling and backward selection for Logistic regression
prediction models in multiply imputed datasets using different selection methods." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psfmi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/psfmi-vignette.html">Welcome to the psfmi package</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mwheymans/psfmi">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pooling and Predictor selection function for Logistic regression
models in multiply imputed datasets</h1>
    <small class="dont-index">Source: <a href='https://github.com/mwheymans/psfmi/blob/master/R/psfmi_lr.R'><code>R/psfmi_lr.R</code></a></small>
    <div class="hidden name"><code>psfmi_lr.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>psfmi_lr</code> Pooling and backward selection for Logistic regression
prediction models in multiply imputed datasets using different selection methods.</p>
    
    </div>

    <pre class="usage"><span class='fu'>psfmi_lr</span>(<span class='no'>data</span>, <span class='kw'>nimp</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>impvar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>Outcome</span>, <span class='kw'>predictors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>p.crit</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cat.predictors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>spline.predictors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>int.predictors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>keep.predictors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>knots</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>print.method</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Data frame or data matrix with stacked multiple imputed datasets.
The original dataset that contains missing values must be excluded from the
dataset. The imputed datasets must be distinguished by an imputation variable,
specified under impvar, and starting by 1.</p></td>
    </tr>
    <tr>
      <th>nimp</th>
      <td><p>A numerical scalar. Number of imputed datasets. Default is 5.</p></td>
    </tr>
    <tr>
      <th>impvar</th>
      <td><p>A character vector. Name of the variable that distinguishes the
imputed datasets.</p></td>
    </tr>
    <tr>
      <th>Outcome</th>
      <td><p>Character vector containing the name of the outcome variable.</p></td>
    </tr>
    <tr>
      <th>predictors</th>
      <td><p>Character vector with the names of the predictor variables.
At least one predictor variable has to be defined.</p></td>
    </tr>
    <tr>
      <th>p.crit</th>
      <td><p>A numerical scalar. P-value selection criterium.</p></td>
    </tr>
    <tr>
      <th>cat.predictors</th>
      <td><p>A single string or a vector of strings to define the
categorical variables. Default is NULL categorical predictors.</p></td>
    </tr>
    <tr>
      <th>spline.predictors</th>
      <td><p>A single string or a vector of strings to define the
(restricted cubic) spline variables. Default is NULL spline predictors. See details.</p></td>
    </tr>
    <tr>
      <th>int.predictors</th>
      <td><p>A single string or a vector of strings with the names of the variables that form
an interaction pair, separated by a “:” symbol.</p></td>
    </tr>
    <tr>
      <th>keep.predictors</th>
      <td><p>A single string or a vector of strings including the variables that are forced
in the model during predictor selection. Categorical and interaction variables are allowed.</p></td>
    </tr>
    <tr>
      <th>knots</th>
      <td><p>A numerical vector that defines the number of knots for each spline predictor separately.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A character vector to indicate the pooling method for p-values to pool the
total model or used during predictor selection. This can be "D1", "D2", "D3" or "MPR".
See details for more information.</p></td>
    </tr>
    <tr>
      <th>print.method</th>
      <td><p>logical vector. If TRUE full matrix with p-values of all variables according to
chosen method (under method) is shown. If FALSE (default) p-value for categorical variables according
to method are shown and for continuous and dichotomous predictors Rubin’s Rules are used.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>psfmi_lr</code> object from which the following objects can be extracted: pooled model as <code>RR_model</code>, 
 pooled p-values according to pooling method as <code>multiparm_p</code>, predictors excluded at each step as <code>coef.excl_step</code>, 
 and <code>impvar</code>, <code>nimp</code>, <code>Outcome</code>, <code>method</code>, <code>p.crit</code>, <code>predictors</code>, 
 <code>cat.predictors</code>, <code>keep.predictors</code>, <code>int.predictors</code>,
 <code>spline.predictors</code>, <code>knots</code>, <code>print.method</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The basic pooling procedure to derive pooled coefficients, standard errors, 95
 confidence intervals and p-values is Rubin's Rules (RR). Specific procedures are
 available to derive pooled p-values for categorical (&gt; 2 categories) and spline variables.
 print.method allows to choose between these pooling methods that are:
 “D1” is pooling of the total covariance matrix, ”D2” is pooling of Chi-square values,
 “D3” is pooling Likelihood ratio statistics (method of Meng and Rubin) and “MPR”
 is pooling of median p-values (MPR rule). Spline regression coefficients are defined
 by using the rcs function for restricted cubic splines of the rms package of Frank Harrell.
 A minimum number of 3 knots as defined under knots is needed.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Eekhout I, van de Wiel MA, Heymans MW. Methods for significance testing of categorical
  covariates in logistic regression models after multiple imputation: power and applicability
  analysis. BMC Med Res Methodol. 2017;17(1):129.</p>
<p>Enders CK (2010). Applied missing data analysis. New York: The Guilford Press.</p>
<p>Meng X-L, Rubin DB. Performing likelihood ratio tests with multiply-imputed data sets.
  Biometrika.1992;79:103-11.</p>
<p>van de Wiel MA, Berkhof J, van Wieringen WN. Testing the prediction error difference between
  2 predictors. Biostatistics. 2009;10:550-60.</p>
<p>Marshall A, Altman DG, Holder RL, Royston P. Combining estimates of interest in prognostic
  modelling studies after multiple imputation: current practice and guidelines. BMC Med Res Methodol.
  2009;9:57.</p>
<p>Van Buuren S. (2018). Flexible Imputation of Missing Data. 2nd Edition. Chapman &amp; Hall/CRC
  Interdisciplinary Statistics. Boca Raton.</p>
<p>http://missingdatasolutions.rbind.io/</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  <span class='no'>pool_lr</span> <span class='kw'>&lt;-</span> <span class='fu'>psfmi_lr</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>lbpmilr</span>, <span class='kw'>nimp</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>impvar</span><span class='kw'>=</span><span class='st'>"Impnr"</span>, <span class='kw'>Outcome</span><span class='kw'>=</span><span class='st'>"Chronic"</span>,
  <span class='kw'>predictors</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Gender"</span>, <span class='st'>"Smoking"</span>, <span class='st'>"Function"</span>, <span class='st'>"JobControl"</span>,
  <span class='st'>"JobDemands"</span>, <span class='st'>"SocialSupport"</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"D1"</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Pooled model correctly estimated</span>
#&gt; <span class='message'>           using a p-value of 1</span></div><div class='input'>  <span class='no'>pool_lr</span>$<span class='no'>RR_Model</span></div><div class='output co'>#&gt; $`Step 1`
#&gt;                   est std.err signif   lower   upper     OR   L.OR     U.OR
#&gt; (Intercept)    1.1637  2.2828 0.6102 -3.3104  5.6379 3.2018 0.0365 280.8649
#&gt; Gender        -0.4220  0.4073 0.3001 -1.2202  0.3762 0.6557 0.2952   1.4568
#&gt; Smoking        0.1164  0.3407 0.7327 -0.5515  0.7842 1.1234 0.5761   2.1907
#&gt; Function      -0.1457  0.0421 0.0005 -0.2282 -0.0632 0.8644 0.7959   0.9387
#&gt; JobControl     0.0021  0.0191 0.9145 -0.0355  0.0396 1.0021 0.9652   1.0404
#&gt; JobDemands    -0.0087  0.0357 0.8065 -0.0787  0.0612 0.9913 0.9243   1.0632
#&gt; SocialSupport  0.0249  0.0540 0.6449 -0.0810  0.1308 1.0252 0.9222   1.1397
#&gt; </div><div class='input'>  <span class='no'>pool_lr</span>$<span class='no'>multiparm_p</span></div><div class='output co'>#&gt; $`Step 1`
#&gt;               Chi_sq D1 &amp; RR p-values
#&gt; Gender         1.074           0.3001
#&gt; Smoking        0.117           0.7327
#&gt; Function      11.984           0.0005
#&gt; JobControl     0.012           0.9145
#&gt; JobDemands     0.060           0.8065
#&gt; SocialSupport  0.212           0.6449
#&gt; </div><div class='input'>
  <span class='no'>pool_lr</span> <span class='kw'>&lt;-</span> <span class='fu'>psfmi_lr</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>lbpmilr</span>, <span class='kw'>nimp</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>impvar</span><span class='kw'>=</span><span class='st'>"Impnr"</span>, <span class='kw'>Outcome</span><span class='kw'>=</span><span class='st'>"Chronic"</span>,
  <span class='kw'>predictors</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Gender"</span>, <span class='st'>"Smoking"</span>, <span class='st'>"Function"</span>, <span class='st'>"JobControl"</span>,
  <span class='st'>"JobDemands"</span>, <span class='st'>"SocialSupport"</span>), <span class='kw'>p.crit</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"D1"</span>)</div><div class='output co'>#&gt; <span class='message'>Variable excluded at Step 1 is - JobControl</span></div><div class='output co'>#&gt; <span class='message'>Variable excluded at Step 2 is - JobDemands</span></div><div class='output co'>#&gt; <span class='message'>Variable excluded at Step 3 is - Smoking</span></div><div class='output co'>#&gt; <span class='message'>Variable excluded at Step 4 is - SocialSupport</span></div><div class='output co'>#&gt; <span class='message'>Variable excluded at Step 5 is - Gender</span></div><div class='input'>  <span class='no'>pool_lr</span>$<span class='no'>RR_Model</span></div><div class='output co'>#&gt; $`Step 1`
#&gt;                   est std.err signif   lower   upper     OR   L.OR     U.OR
#&gt; (Intercept)    1.1637  2.2828 0.6102 -3.3104  5.6379 3.2018 0.0365 280.8649
#&gt; Gender        -0.4220  0.4073 0.3001 -1.2202  0.3762 0.6557 0.2952   1.4568
#&gt; Smoking        0.1164  0.3407 0.7327 -0.5515  0.7842 1.1234 0.5761   2.1907
#&gt; Function      -0.1457  0.0421 0.0005 -0.2282 -0.0632 0.8644 0.7959   0.9387
#&gt; JobControl     0.0021  0.0191 0.9145 -0.0355  0.0396 1.0021 0.9652   1.0404
#&gt; JobDemands    -0.0087  0.0357 0.8065 -0.0787  0.0612 0.9913 0.9243   1.0632
#&gt; SocialSupport  0.0249  0.0540 0.6449 -0.0810  0.1308 1.0252 0.9222   1.1397
#&gt; 
#&gt; $`Step 2`
#&gt;                   est std.err signif   lower   upper     OR   L.OR     U.OR
#&gt; (Intercept)    1.3088  1.8407 0.4770 -2.2988  4.9164 3.7019 0.1004 136.5169
#&gt; Gender        -0.4296  0.4012 0.2843 -1.2158  0.3567 0.6508 0.2965   1.4286
#&gt; Smoking        0.1173  0.3406 0.7305 -0.5502  0.7849 1.1245 0.5768   2.1922
#&gt; Function      -0.1450  0.0415 0.0005 -0.2262 -0.0637 0.8651 0.7975   0.9383
#&gt; JobDemands    -0.0089  0.0357 0.8019 -0.0788  0.0610 0.9911 0.9242   1.0628
#&gt; SocialSupport  0.0239  0.0532 0.6532 -0.0804  0.1282 1.0242 0.9228   1.1367
#&gt; 
#&gt; $`Step 3`
#&gt;                   est std.err signif   lower   upper     OR   L.OR    U.OR
#&gt; (Intercept)    0.9989  1.3631 0.4637 -1.6728  3.6705 2.7152 0.1877 39.2713
#&gt; Gender        -0.4128  0.3955 0.2966 -1.1880  0.3624 0.6618 0.3048  1.4367
#&gt; Smoking        0.1177  0.3406 0.7298 -0.5499  0.7852 1.1249 0.5770  2.1929
#&gt; Function      -0.1448  0.0414 0.0005 -0.2260 -0.0636 0.8652 0.7977  0.9384
#&gt; SocialSupport  0.0236  0.0532 0.6575 -0.0806  0.1278 1.0239 0.9225  1.1363
#&gt; 
#&gt; $`Step 4`
#&gt;                   est std.err signif   lower   upper     OR   L.OR    U.OR
#&gt; (Intercept)    1.0465  1.3564 0.4404 -1.6119  3.7050 2.8477 0.1995 40.6483
#&gt; Gender        -0.4113  0.3954 0.2982 -1.1861  0.3636 0.6628 0.3054  1.4385
#&gt; Function      -0.1432  0.0411 0.0005 -0.2237 -0.0627 0.8666 0.7996  0.9393
#&gt; SocialSupport  0.0231  0.0531 0.6644 -0.0811  0.1272 1.0233 0.9221  1.1356
#&gt; 
#&gt; $`Step 5`
#&gt;                 est std.err signif   lower   upper     OR   L.OR    U.OR
#&gt; (Intercept)  1.5889  0.5348 0.0030  0.5407  2.6371 4.8983 1.7172 13.9725
#&gt; Gender      -0.4196  0.3943 0.2872 -1.1924  0.3531 0.6573 0.3035  1.4235
#&gt; Function    -0.1430  0.0411 0.0005 -0.2235 -0.0625 0.8668 0.7997  0.9394
#&gt; 
#&gt; $`Step 6`
#&gt;                 est std.err signif   lower   upper     OR   L.OR   U.OR
#&gt; (Intercept)  1.3143  0.4622 0.0045  0.4084  2.2203 3.7222 1.5043 9.2097
#&gt; Function    -0.1471  0.0408 0.0003 -0.2272 -0.0671 0.8632 0.7968 0.9351
#&gt; </div><div class='input'>  <span class='no'>pool_lr</span>$<span class='no'>multiparm_p</span></div><div class='output co'>#&gt; $`Step 1`
#&gt;               Chi_sq D1 &amp; RR p-values
#&gt; Gender         1.074           0.3001
#&gt; Smoking        0.117           0.7327
#&gt; Function      11.984           0.0005
#&gt; JobControl     0.012           0.9145
#&gt; JobDemands     0.060           0.8065
#&gt; SocialSupport  0.212           0.6449
#&gt; 
#&gt; $`Step 2`
#&gt;               Chi_sq D1 &amp; RR p-values
#&gt; Gender         1.147           0.2843
#&gt; Smoking        0.119           0.7305
#&gt; Function      12.230           0.0005
#&gt; JobDemands     0.063           0.8019
#&gt; SocialSupport  0.202           0.6532
#&gt; 
#&gt; $`Step 3`
#&gt;               Chi_sq D1 &amp; RR p-values
#&gt; Gender         1.089           0.2966
#&gt; Smoking        0.119           0.7298
#&gt; Function      12.208           0.0005
#&gt; SocialSupport  0.197           0.6575
#&gt; 
#&gt; $`Step 4`
#&gt;               Chi_sq D1 &amp; RR p-values
#&gt; Gender         1.082           0.2982
#&gt; Function      12.147           0.0005
#&gt; SocialSupport  0.188           0.6644
#&gt; 
#&gt; $`Step 5`
#&gt;          Chi_sq D1 &amp; RR p-values
#&gt; Gender    1.133           0.2872
#&gt; Function 12.119           0.0005
#&gt; 
#&gt; $`Step 6`
#&gt;          Chi_sq D1 &amp; RR p-values
#&gt; Function 12.984            3e-04
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Martijn Heymans.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

